\chapter*{Exercises 3}
\section*{Message integrity and authentication}

\textbf{Q1 - Which of the following ones are properties or characteristics of a one-way function?}
\begin{enumerate}
    \textbf{\item[A.] converts an arbitrary length message into a fixed-length value (the digest)}
    \textbf{\item[B.] given the digest value h(m), it should be computationally infeasible to find the corresponding message m}
    \textbf{\item[C.] it should be impossible or infrequent to derive the same digest from two different messages}
    \item[D.] converts a fixed-length message to an arbitrary length value
\end{enumerate}

\textbf{Q2 - Assume Alice sends to Bob a plain message m along with its digest md=h(m) over an insecure channel. Assume Eve is an active attacker controlling the channel between Alice and Bob (i.e. can read, delete, modify, inject data). Bob receives both the message and the digest. What would tell Bob that the message has been modified?}
\begin{enumerate}
    \item[A.] the public key has been altered
    \item[B.] the message digest has been altered
    \item[C.] the message digest computed by Bob is different from the one sent by Alice
    \item[D.] the message extracted by Bob from the digest – i.e. $mBob=h^{-1}(md)$ – is different from the message received m
    \textbf{\item[E.] none of the above}
\end{enumerate}

\textbf{Problem 1 - Alice wants to protect for integrity one file F on her disk (unprotected). She performs these steps: \\
\begin{enumerate}   
    \item[1.] she calculates a digest of the file, D = h(F)
    \item[2.] she copies D on a secure storage (e.g. a USB pen) where she also keeps other sensitive data (e.g. her RSA key-pair)
\end{enumerate} 
After one year, Alice wants to check if F has been illegally modified, so she takes the file F from disk and recalculates the digest on the file, D’ = h(F)\\}
\textbf{What would indicate to Alice that F has been modified?}
\begin{enumerate}
    \item[A.] the file F has a different creation time
    \item[B.] the private key has been altered
    \textbf{\item[C.] the message digest D stored in the secure storage is different from the message digest D’ recalculated on F}
    \item[D.] the message digest D stored in the secure storage is the same as the message digest D’ recalculated on F
    \item[E.] none of the above
\end{enumerate}


\textbf{Q3 - If different messages generate the same hash value, how is this called?}
\begin{enumerate}
    \item[A.] secure hashing
    \textbf{\item[B.] collision}
    \item[C.] MAC generation
    \item[D.] HMAC generation
\end{enumerate}

\textbf{Q4 - Given a message m1, after 100,000 random attempts Alice finds a message m2 that generates the same hash value when calculated with the algorithm H. Is H a secure hash algorithm?}
\begin{enumerate}
    \item[A.] yes
    \textbf{\item[B.] no}
    \item[C.] it depends on the length of the output generated by H
    \item[D.] it depends on the key used in the computation
\end{enumerate}

\textbf{Q5 - HMAC is an algorithm that allows:}
\begin{enumerate}
    \textbf{\item[A.] to combine a message with a symmetric key to provide data authentication and integrity}
    \item[B.] to combine a message with an asymmetric private key to provide data authentication and integrity
    \item[C.] to combine a message with an asymmetric public key to provide data authentication and integrity
    \item[D.] to combine a message with a symmetric key to provide data authentication, integrity, and non-repudiation
    \item[E.] to combine a message with an asymmetric private key to provide data authentication, integrity, and non-repudiation
\end{enumerate}

\textbf{Q6 - Which of the following best describes the difference between HMAC and CBC-MAC?}
\begin{enumerate}
    \item[A.] HMAC creates a message digest and is used for integrity; CBC-MAC is used to encrypt blocks of data for confidentiality
    \item[B.] HMAC uses a symmetric key and a hash algorithm; CBC-MAC uses the first encrypted block as a checksum
    \textbf{\item[C.] HMAC and CBC-MAC provide integrity and data authentication; HMAC uses a hash function, while CBC-MAC uses a block encryption algorithm}
    \item[D.] HMAC encrypts a message with a symmetric key and then puts the results through a hash algorithm; CBC-MAC encrypts the whole message
\end{enumerate}

\textbf{Q7 - Alice wants to protect some messages m1, m2, … mN for data authentication and integrity. She constructs for each message a MAC in the following manner:}
\textbf{\[for (i=1; i<=N; i++) \quad mac(i) = HMAC-SHA256( i, mi );\]}
\textbf{She sends each message mi and the corresponding mac(i)
to Bob over an unprotected channel.
Is data authentication and integrity achieved for all messages
mi? (justify your answer)}
\begin{enumerate}
    \item[A.] yes  
    \textbf{\item[B.] no}
\end{enumerate}

\textbf{Q8 - Alice wants to send Bob a plaintext P protected for confidentiality, authentication, and integrity \\
Alice and Bobs share two symmetric keys K1 and K2 \\
Alice and Bob agreed on two algorithms, A1 (for MAC) and A2 (for symmetric encryption)}
\begin{itemize}
    \item which operations should Alice perform on P and what data
    should she transmit to Bob so that he can recover the plaintext
    and verify its integrity and authenticity?
    \item explain the advantages and disadvantages of your solution 
\end{itemize}


\textbf{Q10  - Authenticated Encryption provides:}
\begin{enumerate}
    \item[A.] confidentiality and authentication/integrity in one step with two different keys
    \textbf{\item[B.] confidentiality and authentication/integrity in one step with one key}
    \item[C.] confidentiality and authentication/integrity in two steps with one key
\end{enumerate}




\section*{X.509v3 certificates, CRL, OCSP, digital signatures}

\textbf{Q1 - Which of the following best describes a Certification Authority?}
\begin{enumerate}
    \item[A.] an organization that issues private keys and the corresponding algorithms
    \item[B.] an organization that certifies encryption algorithms
    \item[C.] an organization that certifies encryption keys
    \textbf{\item[D.] an organization that issues public-key certificates to entities}
\end{enumerate}

\textbf{Q3 - Assume a CA issues an X.509v3 certificate to Alice. Which of the following values are included in the certificate issued to Alice? Select all that apply.}
\begin{itemize}
    \textbf{\item[A.] Alice’s public key}
    \item[B.] Alice’s private key
    \textbf{\item[C.] A signature on Alice’s X.509v3 certificate, calculated with the CA’s private key}
    \item[D.] A signature of the Alice’s X.509v3 certificate, calculated with the CA’s public key
    \textbf{\item[E.] An indication of the owner of the certificate, such as the Alice’s name or e-mail address}
    \textbf{\item[F.] A time period, indicating the lifetime of the certificate}
    \textbf{\item[G.] An indication of the issuer of the certificate, such as the CA’s name}
\end{itemize}

\textbf{Q4 - Why would a Certification Authority revoke a certificate?}
\begin{enumerate}
    \item[A.] if the subject’s public key has been compromised
    \textbf{\item[B.] if the subject’s private key has been compromised}
    \item[C.] if the subject sent the certificate over an unprotected channel
    \item[D.] none of the above
\end{enumerate}

\textbf{Q5 - Which of the following statements about CRL and OCSP are correct?}
\begin{enumerate}
    \textbf{\item[A.] CRL is a list of revoked certificates issued by a CA}
    \item[B.] CRL is a list of revoked certificates issued by a root CA
    \item[C.] OCSP is a protocol to query a server about the validity of a single specific certificate at a specified time
    \textbf{\item[D.] OCSP is a protocol to query a server about the validity of a single specific certificate at the current time}
\end{enumerate}

\textbf{Q6 - Alice sends a digitally signed message to Bob and attaches her X.509v3 certificate (and a certificate chain up to a trusted root CA). Which steps must Bob perform to verify the signature on the message? (you can select multiple responses from the ones below)}
\begin{itemize}
    \textbf{\item[A.] verify the signature on the message by using the certificate of Alice}
    \textbf{\item[B.] verify that the certificate of Alice is authentic by constructing the chain up to a trusted root and verifying the signatures on each certificate in the chain}
    \textbf{\item[C.] verify that each certificate in the chain (except the one of the trusted root) has not been revoked}
    \textbf{\item[D.] do not check the trusted root CA certificate that Alice sent him because he should have it already configured it as trusted}
\end{itemize}

\section*{Exercises - Message integrity & asymmetric crypto}

\textbf{E1a - Alice wants to send to Bob a message P protected for integrity and (data) authentication}
\begin{itemize}
    \item Alice and Bob share a symmetric key K
    \item Alice and Bob agreed about using HMAC-SHA1
\end{itemize}
\textbf{what information should Alice send to Bob? (write the corresponding formulas)\\}

\textbf{E1b - Alice wants to send to Bob a message P protected for integrity and (data) authentication}
\begin{itemize}
    \item Alice and Bob share a symmetric key K
    \item Alice and Bob agreed about using HMAC
\end{itemize}
\textbf{what information should Alice send to Bob? (write the corresponding formulas)\\}

\textbf{E2 - Alice wants to send a confidential message P to Bob … and}
\begin{itemize}
    \item P is large, e.g. 10 GB
    \item P must be protected for 4 months 
\end{itemize}
\textbf{Alice and Bob have agreed about an asymmetric encryption algorithm (RSA), and a symmetric one (AES-128-CBC) and exchanged OOB their respective public keys
\\ write the formulas and the steps\\}

\textbf{E3 - Alice wants to send to Bob a digitally signed message P}
\textbf{assumptions:}
\begin{itemize}
    \item Alice has an RSA key pair ( Alice.SK, Alice.PK )
    \item Bob knows Alice.PK (may be it was exchanged OOB)
\end{itemize}
\textbf{write down the formulas}

\textbf{Problem - Two companies in business wish to protect their messages
(exchanged via an unprotected TCP/IP network) by
providing confidentiality, integrity, and data authentication.
Assuming that the companies do not have access to any
secure channel or data format but share a password pwd
(10 alphanumeric characters long) and can use only basic
symmetric encryption, hash algorithms, and auxiliary
mathematical functions (but not asymmetric encryption),
suggest a possible solution for protecting a message M and
write the formula to generate the protected message P.\\}


\section*{Authentication}
\textbf{Q1 - Which of the following statements correctly describes reusable passwords as an authentication factor?}
\begin{enumerate}
    \item[A.] they are the least expensive and most secure
    \item[B.] they are the most expensive and least secure
    \textbf{\item[C.] they are the least expensive and least secure}
    \item[D.] they are the most expensive and most secure
\end{enumerate}

\textbf{Q2 - Which of the following factors provides stronger authentication?}
\begin{enumerate}
    \item[A.] what a person knows
    \textbf{\item[B.] what a person is}
    \item[C.] what a person has
\end{enumerate}

\textbf{Q3 - How is a challenge/response protocol used with an authentication-token (device)?}
\begin{enumerate}
    \item[A.] this protocol is not used; cryptography is used
    \textbf{\item[B.] an authentication service generates a challenge, then the authentication token generates a response based on the challenge}
    \item[C.] the token challenges the user for a username and password
    \item[D.] the token challenges the user’s password against a database of stored credentials
\end{enumerate}

\textbf{Q4 - What is a dictionary attack?}
\begin{enumerate}
    \textbf{\item[A.] the attacker pre-computes a list of hashes of many "words"; the hashes are then compared with a hashed password (sniffed from the communication channel or leaked from a server)}
    \item[B.] the attacker pre-computes several hashes (for several iterations) starting from a word in the Dictionary; the hashes are then compared with a hashed password (sniffed from the communication channel or leaked from a server)
    \item[C.] the attacker uses a Dictionary of common words (e.g. English language dictionary) to pre-compute a big list of their hashes; the hashes are then compared with a hashed password (sniffed from the communication channel or leaked from a server)
\end{enumerate}

\textbf{Q5 - A salt is used to protect from dictionary attack. A salt is ..}
\begin{enumerate}
    \item[A.] a secret number
    \textbf{\item[B.] a random number, unpredictable}
    \item[C.] a number that must be known only by the user to generate a more secure password
\end{enumerate}

\textbf{Q6 - The advantages of static passwords are (you can choose more than one option):}
\begin{enumerate}
    \textbf{\item[A.] are simple, "free", and require no extra device to carry}
    \item[B.] are immune to sniffing
    \item[C.] are immune to replay attacks
    \textbf{\item[D.] require no trust in a third party (in contrast, public key certificates require trust in the CA)}
    \item[E.] are immune to MITM attacks
\end{enumerate}

\textbf{Q7 - The advantages of OTPs are (you can choose more than one option):}
\begin{enumerate}
    \item[A.] are simple, "free", and require no extra device to carry
    \textbf{\item[B.] sniffing attacks are not efficient}
    \textbf{\item[C.] are immune to replay attacks}
    \textbf{\item[D.] require no trust in a third party (in contrast, public key certificates require trust in the CA)} (Correct if formulated differently)
    \item[E.] are immune to MITM attacks
\end{enumerate}

\textbf{Q8 - A claimant must authenticate to a Verifier by using a symmetric CRA protocol. The advantages in this case are (you can choose multiple options):}
\begin{enumerate}
    \item[A.] the Verifier must not store sensitive keys
    \textbf{\item[B.] sniffing attacks are not efficient}
    \textbf{\item[C.] replay attacks cannot be performed}
    \textbf{\item[D.] require no trust in a third party (in contrast, public key certificates require trust in the CA) or OOB exchange of public keys}
    \textbf{\item[E.] is fast}
    \item[F.] is immune to involuntary signing or to relay attacks (does not require Verifier authentication)
\end{enumerate}

\textbf{Q9 - A claimant must authenticate to a Verifier by using an asymmetric CRA protocol. The advantages in this case are (you can choose multiple options):}
\begin{enumerate}
    \textbf{\item[A.] the Verifier must not store sensitive keys}
    \textbf{\item[B.] sniffing attacks are not efficient}
    \textbf{\item[C.] replay attacks cannot be performed}
    \item[D.] require no trust in a third party (in contrast, public key certificates require trust in the CA) or OOB exchange of public keys
    \item[E.] is fast
    \item[F.] is immune to involuntary signing or relay attacks (does not require Verifier authentication)
\end{enumerate}
